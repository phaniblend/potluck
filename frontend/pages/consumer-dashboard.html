<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Consumer Dashboard - Potluck</title>
    <link rel="stylesheet" href="/css/styles.css?v=202510182000">
    <link rel="stylesheet" href="/css/components.css?v=202510182000">
    <link rel="stylesheet" href="/css/consumer-dashboard.css?v=202510182000">
    <link rel="stylesheet" href="/css/responsive.css?v=202510182000">
</head>
<body>
    <!-- Header -->
    <header class="dashboard-header">
        <div class="header-content">
            <div class="header-left">
                <h1>🍲 Potluck</h1>
                <span class="user-location" id="userLocation">📍 Loading...</span>
            </div>
            <div class="header-right">
                <button class="icon-btn" id="notificationBtn" onclick="toggleNotifications()">
                    🔔
                    <span class="notification-badge" id="notificationBadge" style="display: none;">0</span>
                </button>
                <button class="icon-btn" id="cartBtn" onclick="toggleCart()">
                    🛒
                    <span class="cart-badge" id="cartBadge" style="display: none;">0</span>
                </button>
                <div class="user-menu">
                    <button class="user-btn" onclick="toggleUserMenu()">
                        <span id="userName">User</span>
                        <span>▼</span>
                    </button>
                    <div class="user-dropdown" id="userDropdown" style="display: none;">
                        <a href="#" onclick="showProfile()">👤 Profile</a>
                        <a href="#" onclick="showSettings()">⚙️ Settings</a>
                        <a href="#" onclick="logout()">🚪 Logout</a>
                    </div>
                </div>
            </div>
        </div>
    </header>

    <!-- Notifications Panel -->
    <div class="notifications-panel" id="notificationsPanel" style="display: none;">
        <div class="panel-header">
            <h3>🔔 Notifications</h3>
            <button class="close-btn" onclick="toggleNotifications()">✕</button>
        </div>
        <div class="notifications-list" id="notificationsList">
            <div class="empty-state">
                <p>No new notifications</p>
            </div>
        </div>
    </div>

    <!-- Shopping Cart Panel -->
    <div class="cart-panel" id="cartPanel" style="display: none;">
        <div class="panel-header">
            <h3>🛒 Your Cart</h3>
            <button class="close-btn" onclick="toggleCart()">✕</button>
        </div>
        <div class="cart-items" id="cartItems">
            <div class="empty-state">
                <p>Your cart is empty</p>
            </div>
        </div>
        <div class="cart-footer" id="cartFooter" style="display: none;">
            <div class="cart-total">
                <span>Total:</span>
                <span id="cartTotal">$0.00</span>
            </div>
            <button class="btn btn-primary btn-block" onclick="proceedToCheckout()">
                Proceed to Checkout
            </button>
        </div>
    </div>

    <!-- Main Content -->
    <main class="dashboard-main">
        <!-- Navigation Tabs -->
        <div class="dashboard-tabs">
            <button class="tab-btn active" data-tab="browse" onclick="switchTab('browse')">
                🔍 Browse Food
            </button>
            <button class="tab-btn" data-tab="orders" onclick="switchTab('orders')">
                📦 My Orders
            </button>
            <button class="tab-btn" data-tab="favorites" onclick="switchTab('favorites')">
                ❤️ Favorites
            </button>
            <button class="tab-btn" data-tab="history" onclick="switchTab('history')">
                📜 Order History
            </button>
        </div>

        <!-- Browse Tab -->
        <div class="tab-content active" id="browseTab">
            <!-- Quick Actions -->
            <div class="quick-actions">
                <button class="action-btn" onclick="repeatLastOrder()">
                    🔄 Repeat Last Order
                </button>
            </div>

            <!-- Search & Filters -->
            <div class="search-section">
                <div class="search-bar">
                    <input type="text" id="searchInput" placeholder="Search for dishes, chefs, or cuisine..." onkeyup="searchDishes()">
                    <button class="btn btn-primary" onclick="searchDishes()">🔍 Search</button>
                </div>
                <div class="filters">
                    <select id="areaFilter" onchange="filterDishes()">
                        <option value="">All Areas</option>
                    </select>
                    <select id="cuisineFilter" onchange="filterDishes()">
                        <option value="">All Cuisines</option>
                        <option value="mexican">Mexican</option>
                        <option value="indian">Indian</option>
                        <option value="american">American</option>
                        <option value="italian">Italian</option>
                        <option value="chinese">Chinese</option>
                    </select>
                    <select id="dietaryFilter" onchange="filterDishes()">
                        <option value="">All Dietary</option>
                        <option value="vegetarian">Vegetarian</option>
                        <option value="vegan">Vegan</option>
                        <option value="gluten-free">Gluten-Free</option>
                    </select>
                    <select id="sortFilter" onchange="filterDishes()">
                        <option value="rating">Highest Rated</option>
                        <option value="price-low">Price: Low to High</option>
                        <option value="price-high">Price: High to Low</option>
                        <option value="distance">Nearest</option>
                    </select>
                </div>
            </div>

            <!-- Dishes Grid -->
            <div class="dishes-grid" id="dishesGrid">
                <div class="loading">Loading delicious food...</div>
            </div>
        </div>

        <!-- My Orders Tab -->
        <div class="tab-content" id="ordersTab" style="display: none;">
            <h2>📦 Active Orders</h2>
            <div class="orders-list" id="activeOrdersList">
                <div class="empty-state">
                    <p>No active orders</p>
                </div>
            </div>
        </div>

        <!-- Favorites Tab -->
        <div class="tab-content" id="favoritesTab" style="display: none;">
            <h2>❤️ Your Favorites</h2>
            <div class="favorites-grid" id="favoritesGrid">
                <div class="empty-state">
                    <p>No favorites yet. Start adding dishes you love!</p>
                </div>
            </div>
        </div>

        <!-- Order History Tab -->
        <div class="tab-content" id="historyTab" style="display: none;">
            <h2>📜 Order History</h2>
            <div class="history-list" id="historyList">
                <div class="empty-state">
                    <p>No order history</p>
                </div>
            </div>
        </div>
    </main>

    <!-- Dish Detail Modal -->
    <div class="modal" id="dishModal" style="display: none;">
        <div class="modal-content modal-lg">
            <div class="modal-header">
                <h2 id="dishModalTitle">Dish Details</h2>
                <button class="close-btn" onclick="closeDishModal()">✕</button>
            </div>
            <div class="modal-body" id="dishModalBody">
                <!-- Dish details will be loaded here -->
            </div>
        </div>
    </div>

    <!-- Checkout Modal -->
    <div class="modal" id="checkoutModal" style="display: none;">
        <div class="modal-content modal-lg">
            <div class="modal-header">
                <h2>🛒 Checkout</h2>
                <button class="close-btn" onclick="closeCheckoutModal()">✕</button>
            </div>
            <div class="modal-body">
                <div class="checkout-section">
                    <h3>Delivery Details</h3>
                    <div class="form-group">
                        <label>Delivery Type</label>
                        <div class="radio-group">
                            <label>
                                <input type="radio" name="deliveryType" value="delivery" checked onchange="updateDeliveryType()">
                                🚗 Delivery
                            </label>
                            <label>
                                <input type="radio" name="deliveryType" value="pickup" onchange="updateDeliveryType()">
                                🏃 Pickup
                            </label>
                        </div>
                    </div>
                    <div class="form-group" id="deliveryAddressGroup">
                        <label>Delivery Address</label>
                        <textarea id="deliveryAddress" rows="3" placeholder="Enter your delivery address"></textarea>
                    </div>
                    <div class="form-group">
                        <label>Special Instructions (Optional)</label>
                        <textarea id="specialInstructions" rows="2" placeholder="Any special requests?"></textarea>
                    </div>
                </div>

                <div class="checkout-section">
                    <h3>Order Summary</h3>
                    <div id="checkoutSummary"></div>
                </div>

                <div class="checkout-section">
                    <h3>Payment Method</h3>
                    <select id="paymentMethod" class="form-input">
                        <option value="cash">💵 Cash on Delivery</option>
                        <option value="card">💳 Credit/Debit Card</option>
                        <option value="upi">📱 UPI/Digital Wallet</option>
                    </select>
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn btn-secondary" onclick="closeCheckoutModal()">Cancel</button>
                <button class="btn btn-primary" onclick="placeOrder()">Place Order</button>
            </div>
        </div>
    </div>

    <!-- Rating Modal -->
    <div class="modal" id="ratingModal" style="display: none;">
        <div class="modal-content">
            <div class="modal-header">
                <h2>⭐ Rate Your Experience</h2>
                <button class="close-btn" onclick="closeRatingModal()">✕</button>
            </div>
            <div class="modal-body">
                <div class="rating-section">
                    <h3>Food Quality</h3>
                    <div class="star-rating" id="foodRating">
                        <span class="star" data-rating="1" onclick="setRating('food', 1)">⭐</span>
                        <span class="star" data-rating="2" onclick="setRating('food', 2)">⭐</span>
                        <span class="star" data-rating="3" onclick="setRating('food', 3)">⭐</span>
                        <span class="star" data-rating="4" onclick="setRating('food', 4)">⭐</span>
                        <span class="star" data-rating="5" onclick="setRating('food', 5)">⭐</span>
                    </div>
                </div>

                <div class="rating-section">
                    <h3>Chef Rating</h3>
                    <div class="star-rating" id="chefRating">
                        <span class="star" data-rating="1" onclick="setRating('chef', 1)">⭐</span>
                        <span class="star" data-rating="2" onclick="setRating('chef', 2)">⭐</span>
                        <span class="star" data-rating="3" onclick="setRating('chef', 3)">⭐</span>
                        <span class="star" data-rating="4" onclick="setRating('chef', 4)">⭐</span>
                        <span class="star" data-rating="5" onclick="setRating('chef', 5)">⭐</span>
                    </div>
                </div>

                <div class="rating-section">
                    <h3>Delivery Agent Rating</h3>
                    <div class="star-rating" id="deliveryRating">
                        <span class="star" data-rating="1" onclick="setRating('delivery', 1)">⭐</span>
                        <span class="star" data-rating="2" onclick="setRating('delivery', 2)">⭐</span>
                        <span class="star" data-rating="3" onclick="setRating('delivery', 3)">⭐</span>
                        <span class="star" data-rating="4" onclick="setRating('delivery', 4)">⭐</span>
                        <span class="star" data-rating="5" onclick="setRating('delivery', 5)">⭐</span>
                    </div>
                </div>

                <div class="rating-section">
                    <h3>Tip Delivery Agent (Optional)</h3>
                    <div class="tip-options">
                        <button class="tip-btn" onclick="setTip(0)">No Tip</button>
                        <button class="tip-btn" onclick="setTip(2)">$2</button>
                        <button class="tip-btn" onclick="setTip(5)">$5</button>
                        <button class="tip-btn" onclick="setTip(10)">$10</button>
                        <input type="number" id="customTip" placeholder="Custom amount" min="0" step="0.5">
                    </div>
                </div>

                <div class="rating-section">
                    <h3>Review (Optional)</h3>
                    <textarea id="reviewText" rows="4" placeholder="Share your experience..."></textarea>
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn btn-secondary" onclick="closeRatingModal()">Skip</button>
                <button class="btn btn-primary" onclick="submitRating()">Submit Rating</button>
            </div>
        </div>
    </div>

    <!-- Scripts -->
    <script src="/js/api.js?v=ORDER003"></script>
    <script src="/js/utils.js?v=ORDER003"></script>
    <script src="/js/auth.js?v=ORDER003"></script>
    <script src="/js/location.js?v=ORDER003"></script>
    <script src="/js/consumer.js?v=ORDER003"></script>
    <script>
        // Initialize dashboard on page load
        document.addEventListener('DOMContentLoaded', async () => {
            await initConsumerDashboard();
        });
    </script>
</body>
</html>
